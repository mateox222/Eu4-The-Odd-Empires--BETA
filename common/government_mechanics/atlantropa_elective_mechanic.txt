elective_monarchy_mechanic = {
	alert_icon_gfx = GFX_alerticons_government_mechanics
	alert_icon_index = 18
	available = {
		 OR = {
		current_age = medieval_age
        current_age = age_of_discovery
        }
	}

	powers = {
		noble_support = {
			max = 100
			min = 0
			default = 50
			reset_on_new_ruler = yes
			base_monthly_growth = -0.15
			development_scaled_monthly_growth = 0.03
			is_good = yes
			
			# Scaled modifiers based on noble support
			scaled_modifier = {
				start_value = 0
				end_value = 100
				modifier = {
					legitimacy = 1.0
					diplomatic_upkeep = 1
					stability_cost_modifier = -0.20
					global_tax_modifier = 0.15
					all_estate_loyalty_equilibrium = 0.15

				}
			}
						range_modifier = {
				start_value = 20
				end_value = 39
				modifier = {
					global_unrest = 1
					legitimacy = -0.5
					all_estate_influence_modifier = 0.15
				}
			}
			
			range_modifier = {
				start_value = 0
				end_value = 19
				modifier = {
					global_unrest = 3
					legitimacy = -1.0
					all_estate_influence_modifier = 0.30
					stability_cost_modifier = 0.25
				}
			}
			
			# Range modifiers for different support levels
			
		}
	}
	
	interactions = {
		grant_noble_privileges = {
			  icon = GFX_grant_noble_privileges
			cost_type = noble_support
			cost = 0
			trigger = {
				adm_power = 75
				NOT = { has_country_modifier = recent_noble_privileges }
			}
			effect = {
				add_adm_power = -75
				add_government_power = {
					mechanic_type = elective_monarchy_mechanic
					power_type = noble_support
					value = 25
				}
				add_years_of_income = 0.15
				add_estate_loyalty = {
					estate = estate_nobles
					loyalty = 20
				}
				add_country_modifier = {
					name = expanded_noble_privileges
					duration = 3650 # 10 years
				}
				add_country_modifier = {
					name = recent_noble_privileges
					duration = 1825 # 5 years
				}
			}
			cooldown_years = 5
			ai_chance = {
				factor = 70
				modifier = {
					factor = 2
					has_government_power = {
						mechanic_type = elective_monarchy_mechanic
						power_type = noble_support
						value = 20
					}
					NOT = {
						has_government_power = {
							mechanic_type = elective_monarchy_mechanic
							power_type = noble_support
							value = 60
						}
					}
				}
				modifier = {
					factor = 1.5
					estate_loyalty = {
						estate = estate_nobles
						loyalty = 40
					}
				}
			}
		}
		
		royal_favor_distribution = {
			  icon = GFX_royal_favor_distribution
			cost_type = noble_support
			cost = 12
			trigger = {
				dip_power = 100
				NOT = { has_country_modifier = recent_favor_distribution }
				years_of_income = 0.3
			}
			effect = {
				add_dip_power = -100
				add_years_of_income = -0.3
				add_government_power = {
					mechanic_type = elective_monarchy_mechanic
					power_type = noble_support
					value = 15
				}
				random_list = {
					60 = {
						# Successful distribution
						add_country_modifier = {
							name = successful_royal_favors
							duration = 1825 # 5 years
						}
						random_owned_province = {
							limit = {
								base_tax = 3
								NOT = { has_province_modifier = royal_court_favor }
							}
							add_province_modifier = {
								name = royal_court_favor
								duration = 2190 # 6 years
							}
						}
					}
					40 = {
						# Creates jealousy and competition
						add_country_modifier = {
							name = court_intrigue_intensified
							duration = 1095 # 3 years
						}
						add_estate_loyalty = {
							estate = estate_nobles
							loyalty = -10
						}
					}
				}
				add_country_modifier = {
					name = recent_favor_distribution
					duration = 1095 # 3 years
				}
			}
			cooldown_years = 3
			ai_chance = {
				factor = 55
				modifier = {
					factor = 2
					has_government_power = {
						mechanic_type = elective_monarchy_mechanic
						power_type = noble_support
						value = 40
					}
					NOT = {
						has_government_power = {
							mechanic_type = elective_monarchy_mechanic
							power_type = noble_support
							value = 70
						}
					}
				}
				modifier = {
					factor = 0.5
					NOT = { years_of_income = 1.0 }
				}
			}
		}
		
		secure_succession_support = {
			  icon = GFX_secure_succession_support
			cost_type = noble_support
			cost = 20
			trigger = {
				mil_power = 125
				NOT = { has_country_modifier = succession_support_secured }
				OR = {
					NOT = { heir_age = 15 }
					ruler_age = 55
				}
			}
			effect = {
				add_mil_power = -125
				add_government_power = {
					mechanic_type = elective_monarchy_mechanic
					power_type = noble_support
					value = 18
				}
				add_country_modifier = {
					name = succession_support_secured
					duration = 5475 # 15 years
				}
				if = {
					limit = { has_heir = yes }
					add_heir_claim = 25
				}
				else = {
					add_legitimacy = 15
				}
				random_list = {
					80 = {
						# Strong succession consensus
						add_country_modifier = {
							name = strong_succession_consensus
							duration = 3650 # 10 years
						}
					}
					30 = {
						# Opposition emerges
						add_country_modifier = {
							name = succession_opposition
							duration = 1825 # 5 years
						}
					}
					30 = {	
						add_stability = -1
					}
				}
			}
			cooldown_years = 15
			ai_chance = {
				factor = 80
				modifier = {
					factor = 2
					ruler_age = 60
				}
				modifier = {
					factor = 1.5
					NOT = { heir_claim = 75 }
					has_heir = yes
				}
				modifier = {
					factor = 0.3
					ruler_age = 25
					has_heir = yes
					heir_claim = 90
				}
			}
		}
	}
}